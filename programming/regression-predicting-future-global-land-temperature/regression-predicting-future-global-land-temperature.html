<!DOCTYPE html>
<html>
<head>
    
    <meta charset="utf-8">
<title>REGRESSION: PREDICTING THE GLOBAL LAND TEMPERATURE OF THE EARTH IN 2050 FROM THE PAST DATA &vert; CDSLAB RECIPES - A REPOSITORY FOR ALL SORTS OF PROBLEMS WITH SOLUTIONS</title>
<meta name="description" content="CDSLab Recipes">
<meta name="keywords" content="MATLAB, Python, regression, visualization, plot, line, figure, random number, distribution function, probability density function, PDF, probability, objective function, least squares method">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Regression: Predicting the global land temperature of the Earth in 2050 from the past data">
<meta property="og:description" content="CDSLab Recipes">
<meta property="og:url" content="/recipes/programming/regression-predicting-future-global-land-temperature/regression-predicting-future-global-land-temperature">
<meta property="og:site_name" content="CDSLab Recipes - A repository for all sorts of problems with solutions">
<meta property="og:image" content="/recipes/images/">





<link rel="canonical" href="/recipes/programming/regression-predicting-future-global-land-temperature/regression-predicting-future-global-land-temperature">
<!-- <link href="/recipes/feed.xml" type="application/atom+xml" rel="alternate" title="CDSLab Recipes - A repository for all sorts of problems with solutions Feed"> -->


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,600,300,800,700' rel='stylesheet' type='text/css'>
<!--
<link rel="stylesheet" href="/recipes/assets/css/vendor/font-awesome.min.css">
-->
<link rel="stylesheet" href="/recipes/assets/css/vendor/normalize.css">
<link rel="stylesheet" href="/recipes/assets/css/vendor/nprogress.css">
<link rel="stylesheet" href="/recipes/assets/css/vendor/foundation.min.css">
<link rel="stylesheet" href="/recipes/assets/css/style.css">
<link rel="stylesheet" href="/recipes/assets/css/post.css">

<!--Mathjax LaTeX engine-->
<script>
    var MathJax = {"HTML-CSS": {scale: 100}};
</script>
<style TYPE="text/css">
    code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
</style>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        config: ["MMLorHTML.js"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
        jax: ["input/TeX"],
        tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i = 0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<link rel="shortcut icon" href="/recipes/favicon.ico">

<link href="/recipes/assets/css/prismOkaidia.css" rel="stylesheet" />
<link href="/recipes/assets/css/alert.css" rel="stylesheet" />

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    
</head>
<body class="post-template" itemscope itemtype="https://schema.org/WebPage">



    <main id="notepad-post-container-simple" class="notepad-post-container-simple" role="main">
        <header class="notepad-post-header-simple">
            <div class="notepad-post-menu-header-simple">

                <a class="notepad-blog-logo" href=https://www.cdslab.org target="_blank"><img src="/recipes/images/logo.png" alt="cdslab.org" /></a>
                <div class="notepad-blog-menu">      
                    <div class="notepad-mobile-menu show-for-small">
                        <a href="#"><i class="fa fa-bars"></i></a>
                    </div>
                    <ul class="notepad-menu">
                        <li class="notepad-mobile-close-btn show-for-small text-right">
                            <a href="#"><i class="fa fa-times"></i></a>
                        </li>
                        
                            <li>
                                
                                    <a href="/recipes/">Home</a>
                                
                            </li>
                        
                            <li>
                                
                                    <a href="/recipes/highlights">Highlights</a>
                                
                            </li>
                        
                            <li>
                                
                                    <a href="/recipes/tags">Tags</a>
                                
                            </li>
                        
                            <li>
                                
                                    <a href="/recipes/about">About</a>
                                
                            </li>
                                    
                        <li><a href="/recipes/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
                    </ul>
                </div>
            </div>

                <div class="notepad-post-title-simple row">
                    <div class="small-12 columns">
                        <div class="notepad-post-meta-simple">
                            <h2><a href="/recipes/programming/regression-predicting-future-global-land-temperature/regression-predicting-future-global-land-temperature">Regression: Predicting the global land temperature of the Earth in 2050 from the past data</a></h2>
                            <p>
                                by <strong><a href="https://www.cdslab.org/people/#amir-shahmoradi" target="_blank">Amir Shahmoradi</a></strong>
                                
                                    &#8212; Last updated: 
                                    <strong><time datetime="2019-11-01T00:00:00-05:00">01 November 2019</time></strong>
                                
                                <ul class="tag-box inline">
                                    <span style="margin-right:1rem;">Tags:</span>
                                    
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#MATLAB" data-toggle="tooltip" title="Posts tagged with MATLAB" rel="tag">MATLAB</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#PDF" data-toggle="tooltip" title="Posts tagged with PDF" rel="tag">PDF</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#Python" data-toggle="tooltip" title="Posts tagged with Python" rel="tag">Python</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#distribution function" data-toggle="tooltip" title="Posts tagged with distribution function" rel="tag">distribution function</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#figure" data-toggle="tooltip" title="Posts tagged with figure" rel="tag">figure</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#least squares method" data-toggle="tooltip" title="Posts tagged with least squares method" rel="tag">least squares method</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#line" data-toggle="tooltip" title="Posts tagged with line" rel="tag">line</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#objective function" data-toggle="tooltip" title="Posts tagged with objective function" rel="tag">objective function</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#plot" data-toggle="tooltip" title="Posts tagged with plot" rel="tag">plot</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#probability" data-toggle="tooltip" title="Posts tagged with probability" rel="tag">probability</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#probability density function" data-toggle="tooltip" title="Posts tagged with probability density function" rel="tag">probability density function</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#random number" data-toggle="tooltip" title="Posts tagged with random number" rel="tag">random number</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#regression" data-toggle="tooltip" title="Posts tagged with regression" rel="tag">regression</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#visualization" data-toggle="tooltip" title="Posts tagged with visualization" rel="tag">visualization</a>
                                            </li>
                                            
                                        
                                    
                                </ul>
                            </p>
                            
                        </div>
                    </div>
                </div>
            </div>
        </header>


        <article class="notepad-post-content post tag-simple">

            <div style="text-align:left;">
                
<div style="text-align:center;margin-top:3rem;margin-bottom:2rem;">
    
        <a href="#problem" style="display:inline-block;">
            <h2 id="problem" style="color:red;">
                Problem
            </h2>
        </a>
    
</div>

<p>Consider this dataset, <a href="usaTemperatureHistory.txt" target="_blank">usaTemperatureHistory.txt</a>, which contains the global land temperature of the earth from 1743 to 2013 at every monthly resolution. As stated in the file, temperatures are in Celsius and reported as anomalies relative to the 
average global land temperature of the Earth between Jan 1951 to Dec 1980.</p>

<p>First, plot the data contained in the third column of this file (the <strong>Monthly Anomaly</strong> column starting with $-1.131$) against the year and month of the corresponding row in the file. Note that the year and month of the temperature anomaly are given separately in the first two columns. Therefore, to include all of the months of a given year correctly and consistently on a single plot, you will need to define a new value for the x-axis of the plot, where $x$ represents the year plus the month of the record times $1/13$,</p>

\[x = \rm{year} + \rm{month} / 13 ~~,\]

<p>Note that you will have to write your code in such a way to remove the first 70 lines of text in the file to reach to the data section. The resulting plot should look something like the following,</p>

<figure>
    <img src="GlobalLandTemperatureAnomaly.png" />
</figure>

<p>Clearly, one can see that the global land temperature of the Earth was relatively constant up until around 1880. Afterwards, the global temperature starts to increase consistently over the entire 20th century and beyond (actually, if you look closely, you will notice a bump in the global temperature at around 1950, which can be attributed to the slow-down of the worldâ€™s economy during the second world-war). The around 1970, it seems like the pace of global temperature-increase significantly accelerated compared to the past.</p>

<p>Knowing this, we want to use the data after 1970, up until the most recent recorded temperature in 2013 in this file, to predict what the temperature anomaly of the Earth in the year 2050 will be. By looking at the above plot, it seems plausible that a simple linear regression will give us a good first approximation of the temperature anomaly in 2050. Write a script that fits a line to the temperature data used above from the year 1970 to 2013 and find the parameters of this fit. Then use this fitted line to predict the temperature anomaly of the Earth in 2050. The result of the fitting should be something like the following,</p>

<figure>
    <img src="GlobalLandTemperatureAnomaly2050.png" />
</figure>

<p>where the red line represents the linear-fit to the temperature anomaly data from 1970-2013, and then extrapolates to the temperature anomaly to the year 2050. Interestingly, the predicted temperature-anomaly at year 2050 ($1.9158$) is very close to what the climate scientists have been talking about, for a long time.</p>

<div style="text-align:center;margin-top:2rem;margin-bottom:2rem;">

    <a href="#solution" style="display:inline-block;">
        <h2 id="solution" style="color:blue;">
            Solution
        </h2>
    </a>

</div>

<div style="text-align:center;margin-top:4rem;margin-bottom:1rem;">
    
    
    
    <figure>
        <a href="#solution-matlab" id="solution-matlab">
            <img src="/recipes/images/MATLAB.png" width="75px" />
        </a>
        <figcaption>
            <a href="https://en.wikipedia.org/wiki/MATLAB" target="_blank">
                MATLAB
            </a>
        </figcaption>
    </figure>
</div>

<p>Here is an implementation of this code: <a href="findBestFitParameters.m" target="_blank">findBestFitParameters.m</a>,</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">clear</span> <span class="nb">all</span>
<span class="nb">close</span> <span class="nb">all</span>

<span class="n">Temp</span> <span class="o">=</span> <span class="nb">importdata</span><span class="p">(</span><span class="s1">'usaTemperatureHistory.txt'</span><span class="p">,</span> <span class="s1">' '</span><span class="p">,</span><span class="mi">70</span><span class="p">);</span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">plot</span><span class="p">(</span> <span class="n">Temp</span><span class="o">.</span><span class="n">data</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Temp</span><span class="o">.</span><span class="n">data</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span> <span class="p">/</span> <span class="mf">13.0</span> <span class="k">...</span>
    <span class="p">,</span> <span class="n">Temp</span><span class="o">.</span><span class="n">data</span><span class="p">(:,</span><span class="mi">3</span><span class="p">)</span> <span class="k">...</span>
    <span class="p">,</span> <span class="s1">'linewidth'</span><span class="p">,</span> <span class="mf">0.75</span> <span class="k">...</span>
    <span class="p">);</span>

<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'Year'</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'Temperature (Celsius)'</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'Global Land Temperature Anomaly vs. 1951-1980 Average'</span><span class="p">);</span>
<span class="nb">saveas</span><span class="p">(</span><span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">'GlobalLandTemperatureAnomaly.png'</span><span class="p">)</span>

<span class="n">startRow</span> <span class="o">=</span> <span class="mi">2700</span><span class="p">;</span> <span class="c1">% corresponding to year 1970</span>
<span class="n">ndata</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">Temp</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">startRow</span><span class="p">:</span><span class="k">end</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
<span class="n">DataSet</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">ndata</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">DataSet</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Temp</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">startRow</span><span class="p">:</span><span class="k">end</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Temp</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">startRow</span><span class="p">:</span><span class="k">end</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">/</span> <span class="mf">13.0</span><span class="p">;</span>
<span class="n">DataSet</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Temp</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">startRow</span><span class="p">:</span><span class="k">end</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>

<span class="n">linearFit</span> <span class="o">=</span> <span class="n">fitlm</span><span class="p">(</span><span class="n">DataSet</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">DataSet</span><span class="p">(:,</span><span class="mi">2</span><span class="p">));</span>

<span class="nb">hold</span> <span class="n">on</span><span class="p">;</span>
<span class="n">XValues</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1700</span><span class="p">:</span><span class="mf">0.01</span><span class="p">:</span><span class="mi">2050</span><span class="p">];</span>
<span class="n">YValues</span> <span class="o">=</span> <span class="n">linearFit</span><span class="o">.</span><span class="n">Coefficients</span><span class="o">.</span><span class="n">Estimate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">linearFit</span><span class="o">.</span><span class="n">Coefficients</span><span class="o">.</span><span class="n">Estimate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">XValues</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">(</span> <span class="n">XValues</span><span class="p">,</span> <span class="n">YValues</span> <span class="k">...</span>
    <span class="p">,</span> <span class="s1">'color'</span><span class="p">,</span><span class="s1">'red'</span> <span class="k">...</span>
    <span class="p">,</span><span class="s1">'linewidth'</span><span class="p">,</span><span class="mi">2</span> <span class="k">...</span>
    <span class="p">)</span>
<span class="nb">hold</span> <span class="n">off</span><span class="p">;</span>
</code></pre></div></div>

<div style="text-align:center;margin-top:4rem;margin-bottom:1rem;">
    
    
    
    <figure>
        <a href="#solution-python" id="solution-python">
            <img src="/recipes/images/Python.png" width="75px" />
        </a>
        <figcaption>
            <a href="https://en.wikipedia.org/wiki/Python_(programming_language)" target="_blank">
                Python
            </a>
        </figcaption>
    </figure>
</div>

<p>Here is an implementation of this code in Python: <a href="findBestFitParameters.py" target="_blank">findBestFitParameters.py</a>,</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">sns</span><span class="p">.</span><span class="nb">set</span><span class="p">()</span>

<span class="c1"># download the file from web
</span>
<span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">filePath</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">urllib.request</span>
    <span class="kn">import</span> <span class="nn">shutil</span>
    <span class="k">with</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">as</span> <span class="n">response</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">out_file</span><span class="p">:</span>
        <span class="n">shutil</span><span class="p">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">out_file</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">None</span>

<span class="n">filePath</span> <span class="o">=</span> <span class="s">"./usaTemperatureHistory.txt"</span>
<span class="n">download</span><span class="p">(</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"https://www.cdslab.org/recipes/programming/regression-predicting-future-global-land-temperature/usaTemperatureHistory.txt"</span>
        <span class="p">,</span> <span class="n">filePath</span> <span class="o">=</span> <span class="n">filePath</span>
        <span class="p">)</span>

<span class="c1"># parse the file contents
</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="n">fileLines</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">dates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">anomalies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fileLines</span><span class="p">[</span><span class="mi">70</span><span class="p">:]:</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">double</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
        <span class="n">month</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">double</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">12</span><span class="p">])</span>
        <span class="n">tempDiff</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">double</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">13</span><span class="p">:</span><span class="mi">22</span><span class="p">])</span>
        <span class="n">dates</span><span class="p">.</span><span class="n">append</span><span class="p">(</span> <span class="n">year</span> <span class="o">+</span> <span class="n">month</span><span class="o">/</span><span class="mi">13</span> <span class="p">)</span>
        <span class="n">anomalies</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tempDiff</span><span class="p">)</span>

<span class="c1"># generate the plot
</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">anomalies</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"Year"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">"Temperature (Celsius)"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Global Land Temperature Anomaly vs. 1951-1980 Average"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">"GlobalLandTemperatureAnomalyPython.png"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># do linear fitting
</span>
<span class="k">class</span> <span class="nc">Anomaly</span><span class="p">():</span>
    <span class="n">coef</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dates</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">coef</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dates</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">coef</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">anomaly</span> <span class="o">=</span> <span class="n">Anomaly</span><span class="p">()</span>

<span class="n">startRow</span> <span class="o">=</span> <span class="mi">2700</span><span class="p">;</span> <span class="c1"># corresponding to year 1970
</span><span class="n">anomaly</span><span class="p">.</span><span class="n">coef</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">polyfit</span> <span class="p">(</span> <span class="n">x</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[</span><span class="n">startRow</span><span class="p">:]</span>
                          <span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">anomalies</span><span class="p">[</span><span class="n">startRow</span><span class="p">:]</span>
                          <span class="p">,</span> <span class="n">deg</span> <span class="o">=</span> <span class="mi">1</span>
                          <span class="p">)</span>

<span class="n">dates_range</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1750</span><span class="p">,</span><span class="mi">2051</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># make figure
</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">anomalies</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_range</span><span class="p">,</span><span class="n">anomaly</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">dates_range</span><span class="p">),</span><span class="s">"r"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"Year"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">"Temperature (Celsius)"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Global Land Temperature Anomaly vs. 1951-1980 Average"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">"GlobalLandTemperatureAnomaly2050Python.png"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>


            </div>
        </article>
        <div class="cf"></div>
<div class="row text-center">
    <section class="notepad-post-share">
        <a class="twitter-icon" href="https://twitter.com/intent/tweet?text=&quot;Regression: Predicting the global land temperature of the Earth in 2050 from the past data&quot;%20https://www.cdslab.org/recipes/programming/regression-predicting-future-global-land-temperature/regression-predicting-future-global-land-temperature%20via%20&#64;"
            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
            <i class="fa fa-twitter"></i>
        </a>
        <a class="facebook-icon" href="https://www.facebook.com/sharer/sharer.php?u=https://www.cdslab.org/recipes/programming/regression-predicting-future-global-land-temperature/regression-predicting-future-global-land-temperature"
            onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
            <i class="fa fa-facebook"></i>
        </a>
        
    </section>
</div>
        <div class="cf"></div>
<div class="notepad-author-info">
    <div class="row">
        <section class="notepad-post-author small-12 columns">
            <a href=https://www.shahmoradi.org target="_blank">
                <img src="/recipes/images/AmirShahmoradi.png" class="notepad-post-author-avatar" alt="Amir Shahmoradi's photo">
            </a>
            <span class="author-label">Author</span>
            <h1>Amir Shahmoradi</h1>
            <p><a href="mailto:shahmoradi@utexas.edu" class="author-website">shahmoradi@utexas.edu</a></p>
            <p>Genius is 99% perspiration and 1% inspiration</p>
        </section>
    </div>
</div> 
        <div class="cf"></div>

        <section class="notepad-disqus row">
            <div class="small-12 columns">
                <h1 class="notepad-comments-header">Comments</h1>
                <div id="disqus_thread"></div>
                <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'shahmoradi'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </div>
        </section>

        <div class="cf"></div>
        <footer class="notepad-site-footer">
    <div class="copyright">
         <!-- <section>Last updated 2021 / 03 / 31</section></br> -->
         <section>Last updated Wednesday, 31 Mar 2021 at 02:30 PM CST</section></br>
         <section>All content exclusively maintained by <a href=https://www.shahmoradi.org target="_blank">Amir Shahmoradi</a> <!-- &copy;--> </section></br>
         <section><a class="icon-ghost" href="https://www.uta.edu/physics/" target="_blank">Department of Physics | Data Science Program</a></section></br>
         <section><a class="icon-ghost" href="https://www.uta.edu/" target="_blank">The University of Texas at Arlington</a></section></br>
         <section>SEIR 365 | Arlington TX 76010</section></br>
    </div>
    <div class="social-icons">

        
        <a href="https://facebook.com/cdslab" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-facebook fa-stack-1x"></i>
            </span>
        </a>
        

        
        <a href="https://github.com/cdslaborg" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-github fa-stack-1x"></i>
            </span>
        </a>
        

        

        
        <a href="https://instagram.com/cdslaborg" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-instagram fa-stack-1x"></i>
            </span>
        </a>
        

        
        <a href="https://medium.com/cdslab" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-medium fa-stack-1x"></i>
                <!--
                -->
            </span>
        </a>
        

        
        <a href="https://twitter.com/cdslaborg" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-twitter fa-stack-1x"></i>
            </span>
        </a>
        
        
<div style="color: #000000; float: none; width: 100%; padding-top: 1rem;">
    <span style="font-size:0.8em">visitor count: 
        <script type="text/javascript">
            var sc_project=12051053; 
            var sc_invisible=0; 
            var sc_security="e095256f"; 
            var sc_text=3; 
            var scJsHost = "https://";
            document.write("<sc"+"ript type='text/javascript' src='" + scJsHost + 
            "statcounter.com/counter/counter.js'></"+"script>");
        </script>
    </span>
</div>


    </div>
    <div class="cf"></div>
</footer> 
    </main>
    <!--dynamic page header-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="/recipes/assets/js/vendor/jquery-1.11.1.min.js"><\/script>')</script>
  <script src="/recipes/assets/js/vendor/modernizr.js"></script>
  <script src="/recipes/assets/js/foundation.min.js"></script>
  
  <script src="/recipes/assets/js/notepad.js"></script>
  <script src="/recipes/assets/js/scripts.min.js"></script>
  <script src="/recipes/assets/js/vendor/nprogress.js"></script>
  
  <script>
    $(document).foundation();
  </script>
  <script type='text/javascript'>console.log("N/A");</script>
  <script type='text/javascript'>console.log("https://www.cdslab.org/");</script>

<!--header anchor links-->
<script src="/recipes/assets/js/autoAnchorLink.js"></script>

<!-- <script src="/recipes/assets/js/prismOkaidia.js"></script>
<script src="/recipes/assets/js/prismTwilight.js"></script>
<script src="/recipes/assets/js/prismDefault.js"></script>
 -->
<script src="/recipes/assets/js/prismCoy.js"></script> 
    <!--automatic Table of Content.-->
    <script src="/recipes/assets/js/autoTOC.js"></script>
</body>
</html>
