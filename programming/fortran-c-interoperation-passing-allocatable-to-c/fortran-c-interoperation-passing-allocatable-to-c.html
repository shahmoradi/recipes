<!DOCTYPE html>
<html>
<head>
    
    <meta charset="utf-8">
<title>PASSING ALLOCATABLE STRING FROM FORTRAN TO C &vert; CDSLAB RECIPES - A REPOSITORY FOR ALL SORTS OF PROBLEMS WITH SOLUTIONS</title>
<meta name="description" content="CDSLab Recipes">
<meta name="keywords" content="interoperation, compiler, Intel, Windows, alias, name mangling, bind, Fortran, C, function, iso_fortran_env, iso_c_binding, char, string">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Passing allocatable string from Fortran to C">
<meta property="og:description" content="CDSLab Recipes">
<meta property="og:url" content="/recipes/programming/fortran-c-interoperation-passing-allocatable-to-c/fortran-c-interoperation-passing-allocatable-to-c">
<meta property="og:site_name" content="CDSLab Recipes - A repository for all sorts of problems with solutions">
<meta property="og:image" content="/recipes/images/">





<link rel="canonical" href="/recipes/programming/fortran-c-interoperation-passing-allocatable-to-c/fortran-c-interoperation-passing-allocatable-to-c">
<!-- <link href="/recipes/feed.xml" type="application/atom+xml" rel="alternate" title="CDSLab Recipes - A repository for all sorts of problems with solutions Feed"> -->


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,600,300,800,700' rel='stylesheet' type='text/css'>
<!--
<link rel="stylesheet" href="/recipes/assets/css/vendor/font-awesome.min.css">
-->
<link rel="stylesheet" href="/recipes/assets/css/vendor/normalize.css">
<link rel="stylesheet" href="/recipes/assets/css/vendor/nprogress.css">
<link rel="stylesheet" href="/recipes/assets/css/vendor/foundation.min.css">
<link rel="stylesheet" href="/recipes/assets/css/style.css">
<link rel="stylesheet" href="/recipes/assets/css/post.css">

<!--Mathjax LaTeX engine-->
<script>
    var MathJax = {"HTML-CSS": {scale: 100}};
</script>
<style TYPE="text/css">
    code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
</style>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        config: ["MMLorHTML.js"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
        jax: ["input/TeX"],
        tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i = 0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<link rel="shortcut icon" href="/recipes/favicon.ico">

<link href="/recipes/assets/css/prismOkaidia.css" rel="stylesheet" />
<link href="/recipes/assets/css/alert.css" rel="stylesheet" />

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    
</head>
<body class="post-template" itemscope itemtype="https://schema.org/WebPage">



    <main id="notepad-post-container-simple" class="notepad-post-container-simple" role="main">
        <header class="notepad-post-header-simple">
            <div class="notepad-post-menu-header-simple">

                <a class="notepad-blog-logo" href=https://www.cdslab.org target="_blank"><img src="/recipes/images/logo.png" alt="cdslab.org" /></a>
                <div class="notepad-blog-menu">      
                    <div class="notepad-mobile-menu show-for-small">
                        <a href="#"><i class="fa fa-bars"></i></a>
                    </div>
                    <ul class="notepad-menu">
                        <li class="notepad-mobile-close-btn show-for-small text-right">
                            <a href="#"><i class="fa fa-times"></i></a>
                        </li>
                        
                            <li>
                                
                                    <a href="/recipes/">Home</a>
                                
                            </li>
                        
                            <li>
                                
                                    <a href="/recipes/highlights">Highlights</a>
                                
                            </li>
                        
                            <li>
                                
                                    <a href="/recipes/tags">Tags</a>
                                
                            </li>
                        
                            <li>
                                
                                    <a href="/recipes/about">About</a>
                                
                            </li>
                                    
                        <li><a href="/recipes/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
                    </ul>
                </div>
            </div>

                <div class="notepad-post-title-simple row">
                    <div class="small-12 columns">
                        <div class="notepad-post-meta-simple">
                            <h2><a href="/recipes/programming/fortran-c-interoperation-passing-allocatable-to-c/fortran-c-interoperation-passing-allocatable-to-c">Passing allocatable string from Fortran to C</a></h2>
                            <p>
                                by <strong><a href="https://www.cdslab.org/people/#amir-shahmoradi" target="_blank">Amir Shahmoradi</a></strong>
                                
                                    &#8212; Last updated: 
                                    <strong><time datetime="2019-08-04T00:00:00-05:00">04 August 2019</time></strong>
                                
                                <ul class="tag-box inline">
                                    <span style="margin-right:1rem;">Tags:</span>
                                    
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#C" data-toggle="tooltip" title="Posts tagged with C" rel="tag">C</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#Fortran" data-toggle="tooltip" title="Posts tagged with Fortran" rel="tag">Fortran</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#Intel" data-toggle="tooltip" title="Posts tagged with Intel" rel="tag">Intel</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#Windows" data-toggle="tooltip" title="Posts tagged with Windows" rel="tag">Windows</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#alias" data-toggle="tooltip" title="Posts tagged with alias" rel="tag">alias</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#bind" data-toggle="tooltip" title="Posts tagged with bind" rel="tag">bind</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#char" data-toggle="tooltip" title="Posts tagged with char" rel="tag">char</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#compiler" data-toggle="tooltip" title="Posts tagged with compiler" rel="tag">compiler</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#function" data-toggle="tooltip" title="Posts tagged with function" rel="tag">function</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#interoperation" data-toggle="tooltip" title="Posts tagged with interoperation" rel="tag">interoperation</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#iso_c_binding" data-toggle="tooltip" title="Posts tagged with iso_c_binding" rel="tag">iso_c_binding</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#iso_fortran_env" data-toggle="tooltip" title="Posts tagged with iso_fortran_env" rel="tag">iso_fortran_env</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#name mangling" data-toggle="tooltip" title="Posts tagged with name mangling" rel="tag">name mangling</a>
                                            </li>
                                            
                                        
                                            <li>
                                                <a href="/recipes/tags/index.html#string" data-toggle="tooltip" title="Posts tagged with string" rel="tag">string</a>
                                            </li>
                                            
                                        
                                    
                                </ul>
                            </p>
                            
                        </div>
                    </div>
                </div>
            </div>
        </header>


        <article class="notepad-post-content post tag-simple">

            <div style="text-align:left;">
                
<div style="text-align:center;margin-top:3rem;margin-bottom:2rem;">
    
        <a href="#problem" style="display:inline-block;">
            <h2 id="problem" style="color:red;">
                Problem
            </h2>
        </a>
    
</div>

<p>Consider the following example Fortran function <code class="highlighter-rouge">replaceStr</code> which takes a <code class="highlighter-rouge">string</code> of arbitrary length as input and <code class="highlighter-rouge">search</code> string. Then it searches for patterns in the input <code class="highlighter-rouge">string</code> that match the <code class="highlighter-rouge">search</code> string and replaces them with the input string <code class="highlighter-rouge">substitute</code> and outputs the resulting string as <code class="highlighter-rouge">modifiedString</code>,</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span><span class="w"> </span><span class="n">String_mod</span><span class="w">
    </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
</span><span class="k">contains</span><span class="w">
    </span><span class="k">recursive</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">replaceStr</span><span class="p">(</span><span class="n">string</span><span class="p">,</span><span class="n">search</span><span class="p">,</span><span class="n">substitute</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">modifiedString</span><span class="p">)</span><span class="w">
        </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">IK</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">int32</span><span class="w">
        </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
        </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">  </span><span class="p">::</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">search</span><span class="p">,</span><span class="w"> </span><span class="n">substitute</span><span class="w">
        </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">modifiedString</span><span class="w">
        </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span><span class="w">                   </span><span class="p">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">stringLen</span><span class="p">,</span><span class="w"> </span><span class="n">searchLen</span><span class="w">
        </span><span class="n">stringLen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="w">
        </span><span class="n">searchLen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">search</span><span class="p">)</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">stringLen</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="ow">.or.</span><span class="w"> </span><span class="n">searchLen</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">
            </span><span class="n">modifiedString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="w">
            </span><span class="k">return</span><span class="w">
        </span><span class="k">elseif</span><span class="w"> </span><span class="p">(</span><span class="n">stringLen</span><span class="o">&lt;</span><span class="n">searchLen</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">
            </span><span class="n">modifiedString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">string</span><span class="w">
            </span><span class="k">return</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="w">
        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="k">do</span><span class="w">
            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">searchLen</span><span class="mi">-1</span><span class="p">)</span><span class="o">==</span><span class="n">search</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">
                </span><span class="n">modifiedString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">string</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">//</span><span class="w"> </span><span class="n">substitute</span><span class="w"> </span><span class="p">//</span><span class="w"> </span><span class="n">replaceStr</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">searchLen</span><span class="p">:</span><span class="n">stringLen</span><span class="p">),</span><span class="n">search</span><span class="p">,</span><span class="n">substitute</span><span class="p">)</span><span class="w">
                </span><span class="k">exit</span><span class="w">
            </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="w">
            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">searchLen</span><span class="o">&gt;</span><span class="n">stringLen</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">
                </span><span class="n">modifiedString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">string</span><span class="w">
                </span><span class="k">exit</span><span class="w">
            </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="w">
            </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">
            </span><span class="k">cycle</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">do</span><span class="w">
    </span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">replaceStr</span><span class="w">
</span><span class="k">end</span><span class="w"> </span><span class="k">module</span><span class="w"> </span><span class="n">String_mod</span><span class="w">
</span></code></pre></div></div>

<p>Note that the output of the function is an allocatable variable. Rewrite this function as a Fortran subroutine and revise the procedure’s interface such it can be called from the C programming language. Then, write a C function to test if it works.</p>

<p>Rewrite this function in such a way that it can be called from the C programming language. Then write a C program that calls this function and print the output of the function on the screen.</p>

<div style="text-align:center;margin-top:2rem;margin-bottom:2rem;">

    <a href="#solution" style="display:inline-block;">
        <h2 id="solution" style="color:blue;">
            Solution
        </h2>
    </a>

</div>

<div style="text-align:center;margin-top:4rem;margin-bottom:1rem;">
    
    
    
    <figure>
        <a href="#solution-fortran" id="solution-fortran">
            <img src="/recipes/images/Fortran.png" width="75px" />
        </a>
        <figcaption>
            <a href="https://en.wikipedia.org/wiki/Fortran" target="_blank">
                Fortran
            </a>
        </figcaption>
    </figure>
</div>

<p>In this specific case, a simple solution is to keep the original <code class="highlighter-rouge">replaceStr</code> function intact and intead, write a Fortran subroutine wrapper that takes arguments from C and returns allocatable string to C.</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span><span class="w"> </span><span class="n">String_mod</span><span class="w">
    </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
</span><span class="k">contains</span><span class="w">
    </span><span class="k">subroutine</span><span class="w"> </span><span class="n">replaceStrC</span><span class="w">  </span><span class="p">(</span><span class="w"> </span><span class="n">StrVec</span><span class="w">            </span><span class="p">&amp;</span><span class="w">
                            </span><span class="p">,</span><span class="w"> </span><span class="n">lenStrVec</span><span class="w">         </span><span class="p">&amp;</span><span class="w">
                            </span><span class="p">,</span><span class="w"> </span><span class="n">SearchVec</span><span class="w">         </span><span class="p">&amp;</span><span class="w">
                            </span><span class="p">,</span><span class="w"> </span><span class="n">lenSearchVec</span><span class="w">      </span><span class="p">&amp;</span><span class="w">
                            </span><span class="p">,</span><span class="w"> </span><span class="n">SubstituteVec</span><span class="w">     </span><span class="p">&amp;</span><span class="w">
                            </span><span class="p">,</span><span class="w"> </span><span class="n">lenSubstituteVec</span><span class="w">  </span><span class="p">&amp;</span><span class="w">
                            </span><span class="p">,</span><span class="w"> </span><span class="n">StrOut</span><span class="w">            </span><span class="p">&amp;</span><span class="w">
                            </span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w">              </span><span class="p">&amp;</span><span class="w">
                            </span><span class="p">)</span><span class="w"> </span><span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s2">"replaceStr"</span><span class="p">)</span><span class="w">

        </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">iso_c_binding</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">c_int</span><span class="p">,</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"> </span><span class="n">c_size_t</span><span class="p">,</span><span class="w"> </span><span class="n">c_null_char</span><span class="p">,</span><span class="w"> </span><span class="nb">c_f_pointer</span><span class="p">,</span><span class="w"> </span><span class="nb">c_loc</span><span class="w">
        </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">IK</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">int32</span><span class="w">

        </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">c_char</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">                        </span><span class="p">::</span><span class="w"> </span><span class="n">StrVec</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">SearchVec</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">SubstituteVec</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">
        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">c_size_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">),</span><span class="w"> </span><span class="k">value</span><span class="w">                       </span><span class="p">::</span><span class="w"> </span><span class="n">lenStrVec</span><span class="p">,</span><span class="w"> </span><span class="n">lenSearchVec</span><span class="p">,</span><span class="w"> </span><span class="n">lenSubstituteVec</span><span class="w">
        </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">c_char</span><span class="p">,</span><span class="w"> </span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">out</span><span class="p">)</span><span class="w">         </span><span class="p">::</span><span class="w"> </span><span class="n">StrOut</span><span class="p">(:)</span><span class="w">
        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">c_int</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">inout</span><span class="p">)</span><span class="w">                              </span><span class="p">::</span><span class="w"> </span><span class="n">ierr</span><span class="w">

        </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">lenStrVec</span><span class="p">)</span><span class="w">                                        </span><span class="p">::</span><span class="w"> </span><span class="n">string</span><span class="w">
        </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">lenSearchVec</span><span class="p">)</span><span class="w">                                     </span><span class="p">::</span><span class="w"> </span><span class="n">search</span><span class="w">
        </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">lenSubstituteVec</span><span class="p">)</span><span class="w">                                 </span><span class="p">::</span><span class="w"> </span><span class="n">substitute</span><span class="w">
        </span><span class="kt">character</span><span class="p">(:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w">                                       </span><span class="p">::</span><span class="w"> </span><span class="n">modifiedString</span><span class="w">
        </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span><span class="w">                                                     </span><span class="p">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">lenModifiedString</span><span class="w">

        </span><span class="c1">! Construct the Fortran strings first.</span><span class="w">
        </span><span class="c1">! Note that rigorous error handling is ignored here.</span><span class="w">
        </span><span class="k">do</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">lenStrVec</span><span class="p">,</span><span class="w"> </span><span class="nb">kind</span><span class="o">=</span><span class="n">IK</span><span class="p">)</span><span class="w">
            </span><span class="n">string</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StrVec</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">do</span><span class="w">
        </span><span class="k">do</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">lenSearchVec</span><span class="p">,</span><span class="w"> </span><span class="nb">kind</span><span class="o">=</span><span class="n">IK</span><span class="p">)</span><span class="w">
            </span><span class="n">search</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SearchVec</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">do</span><span class="w">
        </span><span class="k">do</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">lenSubstituteVec</span><span class="p">,</span><span class="w"> </span><span class="nb">kind</span><span class="o">=</span><span class="n">IK</span><span class="p">)</span><span class="w">
            </span><span class="n">substitute</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SubstituteVec</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">do</span><span class="w">

        </span><span class="c1">! Now call the Fortran function replaceStr(). </span><span class="w">
        </span><span class="n">modifiedString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">replaceStr</span><span class="p">(</span><span class="n">string</span><span class="p">,</span><span class="n">search</span><span class="p">,</span><span class="n">substitute</span><span class="p">)</span><span class="w">
        </span><span class="n">lenModifiedString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">modifiedString</span><span class="p">)</span><span class="w">
        </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">"(*(g0,:,''))"</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s2">"@Fortran@replaceStrC(): string received from C = "</span><span class="p">,</span><span class="w"> </span><span class="n">string</span><span class="w">
        </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">"(*(g0,:,''))"</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s2">"@Fortran@replaceStrC(): modified string by replaceStr() = "</span><span class="p">,</span><span class="w"> </span><span class="n">modifiedString</span><span class="w">
        </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">StrOut</span><span class="p">(</span><span class="n">lenModifiedString</span><span class="mi">+1</span><span class="p">),</span><span class="w"> </span><span class="n">stat</span><span class="o">=</span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">/</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w">
        </span><span class="k">do</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">lenModifiedString</span><span class="w">
            </span><span class="n">StrOut</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modifiedString</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">do</span><span class="w">
        </span><span class="n">StrOut</span><span class="p">(</span><span class="n">lenModifiedString</span><span class="mi">+1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c_null_char</span><span class="w">
        </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">"(*(g0,:,''))"</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s2">"@Fortran@replaceStrC(): modified allocatable string passed to C = "</span><span class="p">,</span><span class="w"> </span><span class="n">StrOut</span><span class="w">

    </span><span class="k">end</span><span class="w"> </span><span class="k">subroutine</span><span class="w"> </span><span class="n">replaceStrC</span><span class="w">

    </span><span class="k">recursive</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">replaceStr</span><span class="p">(</span><span class="n">string</span><span class="p">,</span><span class="n">search</span><span class="p">,</span><span class="n">substitute</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">modifiedString</span><span class="p">)</span><span class="w">
        </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">IK</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">int32</span><span class="w">
        </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
        </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">  </span><span class="p">::</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">search</span><span class="p">,</span><span class="w"> </span><span class="n">substitute</span><span class="w">
        </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">modifiedString</span><span class="w">
        </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span><span class="w">                   </span><span class="p">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">stringLen</span><span class="p">,</span><span class="w"> </span><span class="n">searchLen</span><span class="w">
        </span><span class="n">stringLen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="w">
        </span><span class="n">searchLen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">search</span><span class="p">)</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">stringLen</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="ow">.or.</span><span class="w"> </span><span class="n">searchLen</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">
            </span><span class="n">modifiedString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="w">
            </span><span class="k">return</span><span class="w">
        </span><span class="k">elseif</span><span class="w"> </span><span class="p">(</span><span class="n">stringLen</span><span class="o">&lt;</span><span class="n">searchLen</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">
            </span><span class="n">modifiedString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">string</span><span class="w">
            </span><span class="k">return</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="w">
        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="k">do</span><span class="w">
            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">searchLen</span><span class="mi">-1</span><span class="p">)</span><span class="o">==</span><span class="n">search</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">
                </span><span class="n">modifiedString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">string</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">//</span><span class="w"> </span><span class="n">substitute</span><span class="w"> </span><span class="p">//</span><span class="w"> </span><span class="n">replaceStr</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">searchLen</span><span class="p">:</span><span class="n">stringLen</span><span class="p">),</span><span class="n">search</span><span class="p">,</span><span class="n">substitute</span><span class="p">)</span><span class="w">
                </span><span class="k">exit</span><span class="w">
            </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="w">
            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">searchLen</span><span class="o">&gt;</span><span class="n">stringLen</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">
                </span><span class="n">modifiedString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">string</span><span class="w">
                </span><span class="k">exit</span><span class="w">
            </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="w">
            </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">
            </span><span class="k">cycle</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">do</span><span class="w">
    </span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">replaceStr</span><span class="w">

</span><span class="k">end</span><span class="w"> </span><span class="k">module</span><span class="w"> </span><span class="n">String_mod</span><span class="w">
</span></code></pre></div></div>

<div style="text-align:center;margin-top:4rem;margin-bottom:1rem;">
    
    
    
    <figure>
        <a href="#solution-c" id="solution-c">
            <img src="/recipes/images/C.png" width="75px" />
        </a>
        <figcaption>
            <a href="https://en.wikipedia.org/wiki/C_(programming_language)" target="_blank">
                C
            </a>
        </figcaption>
    </figure>
</div>

<p>The above Fortran subroutine can be now called from C via,</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;ISO_Fortran_binding.h&gt;
</span>
<span class="c1">// Prototype for the Fortran procedure</span>
<span class="kt">void</span> <span class="nf">replaceStr</span> <span class="p">(</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span>
                <span class="p">,</span> <span class="kt">size_t</span>
                <span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span>
                <span class="p">,</span> <span class="kt">size_t</span>
                <span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span>
                <span class="p">,</span> <span class="kt">size_t</span>
                <span class="p">,</span> <span class="n">CFI_cdesc_t</span> <span class="o">*</span>
                <span class="p">,</span> <span class="kt">int</span> <span class="o">*</span>
                <span class="p">);</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">char</span><span class="o">*</span> <span class="n">string</span> <span class="o">=</span> <span class="s">"This is a C string"</span><span class="p">;</span>
    <span class="kt">char</span><span class="o">*</span> <span class="n">search</span> <span class="o">=</span> <span class="s">" "</span><span class="p">;</span>
    <span class="kt">char</span><span class="o">*</span> <span class="n">substitute</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"@C@main(): string pass to Fortran = %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">string</span><span class="p">);</span>

    <span class="c1">// You may find it easier to work with the macro from ISO_Fortran_binding.h</span>
    <span class="n">CFI_CDESC_T</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">stringModified</span><span class="p">;</span>

    <span class="c1">// Initialize the C descriptor as a scalar character nonpointer data type</span>
    <span class="kt">int</span> <span class="n">ierr</span> <span class="o">=</span> <span class="n">CFI_establish</span><span class="p">(</span> <span class="p">(</span><span class="n">CFI_cdesc_t</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">stringModified</span>
                            <span class="p">,</span> <span class="nb">NULL</span>
                            <span class="p">,</span> <span class="n">CFI_attribute_allocatable</span>
                            <span class="p">,</span> <span class="n">CFI_type_char</span>
                            <span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span>
                            <span class="p">,</span> <span class="p">(</span><span class="n">CFI_rank_t</span><span class="p">)</span><span class="mi">1</span>
                            <span class="p">,</span> <span class="nb">NULL</span>
                            <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">!=</span> <span class="n">CFI_SUCCESS</span><span class="p">)</span> <span class="k">return</span><span class="p">(</span><span class="n">ierr</span><span class="p">);</span>

    <span class="c1">// Call the Fortran procedure for string manipulation</span>
    <span class="n">replaceStr</span>  <span class="p">(</span> <span class="n">string</span>
                <span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
                <span class="p">,</span> <span class="n">search</span>
                <span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">search</span><span class="p">)</span>
                <span class="p">,</span> <span class="n">substitute</span>
                <span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">substitute</span><span class="p">)</span>
                <span class="p">,</span> <span class="p">(</span><span class="n">CFI_cdesc_t</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">stringModified</span>
                <span class="p">,</span> <span class="o">&amp;</span><span class="n">ierr</span>
                <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Fortran allocation failed: ierr = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ierr</span><span class="p">);</span>
        <span class="k">return</span><span class="p">(</span><span class="n">ierr</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Consume the modified "string" which is effectively (char *)stringModified.base_addr</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"@C@main(): modified allocatable string received from Fortran subroutine replaceStr = %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">stringModified</span><span class="p">.</span><span class="n">base_addr</span><span class="p">);</span>

    <span class="c1">// Free the CFI decriptor object used for Fortran-C interoperability</span>
    <span class="n">ierr</span> <span class="o">=</span> <span class="n">CFI_deallocate</span><span class="p">(</span> <span class="p">(</span><span class="n">CFI_cdesc_t</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">stringModified</span> <span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ierr</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ifort <span class="nt">-c</span> String_mod.f90
icl <span class="nt">-c</span> mainReplaceStr.c
icl String_mod.obj mainReplaceStr.obj <span class="nt">-o</span> a.exe 
a.exe
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@C@main(): string pass to Fortran = This is a C string
@Fortran@replaceStrC(): string received from C = This is a C string
@Fortran@replaceStrC(): modified string by replaceStr() = ThisisaCstring
@Fortran@replaceStrC(): modified allocatable string passed to C = ThisisaCstring
@C@main(): modified allocatable string received from Fortran subroutine replaceStr = ThisisaCstring
</code></pre></div></div>

<p class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:</b> Notice the C null terminating character that appears at the end of the output allocatable string vector from Fortran subroutine. This null character is necessary. Since the length of the allocatable is not explicitly passed, the C code will not know the length of the allocatable string that is passed to C without the null terminating character at its end.</p>


            </div>
        </article>
        <div class="cf"></div>
<div class="row text-center">
    <section class="notepad-post-share">
        <a class="twitter-icon" href="https://twitter.com/intent/tweet?text=&quot;Passing allocatable string from Fortran to C&quot;%20https://www.cdslab.org/recipes/programming/fortran-c-interoperation-passing-allocatable-to-c/fortran-c-interoperation-passing-allocatable-to-c%20via%20&#64;"
            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
            <i class="fa fa-twitter"></i>
        </a>
        <a class="facebook-icon" href="https://www.facebook.com/sharer/sharer.php?u=https://www.cdslab.org/recipes/programming/fortran-c-interoperation-passing-allocatable-to-c/fortran-c-interoperation-passing-allocatable-to-c"
            onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
            <i class="fa fa-facebook"></i>
        </a>
        
    </section>
</div>
        <div class="cf"></div>
<div class="notepad-author-info">
    <div class="row">
        <section class="notepad-post-author small-12 columns">
            <a href=https://www.shahmoradi.org target="_blank">
                <img src="/recipes/images/AmirShahmoradi.png" class="notepad-post-author-avatar" alt="Amir Shahmoradi's photo">
            </a>
            <span class="author-label">Author</span>
            <h1>Amir Shahmoradi</h1>
            <p><a href="mailto:shahmoradi@utexas.edu" class="author-website">shahmoradi@utexas.edu</a></p>
            <p>Genius is 99% perspiration and 1% inspiration</p>
        </section>
    </div>
</div> 
        <div class="cf"></div>

        <section class="notepad-disqus row">
            <div class="small-12 columns">
                <h1 class="notepad-comments-header">Comments</h1>
                <div id="disqus_thread"></div>
                <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'shahmoradi'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </div>
        </section>

        <div class="cf"></div>
        <footer class="notepad-site-footer">
    <div class="copyright">
         <!-- <section>Last updated 2019 / 11 / 20</section></br> -->
         <section>Last updated Wednesday, 20 Nov 2019 at 10:39 PM CST</section></br>
         <section>All content exclusively maintained by <a href=https://www.shahmoradi.org target="_blank">Amir Shahmoradi</a> <!-- &copy;--> </section></br>
         <section><a class="icon-ghost" href="https://www.uta.edu/physics/" target="_blank">Department of Physics | Data Science Program</a></section></br>
         <section><a class="icon-ghost" href="https://www.uta.edu/" target="_blank">The University of Texas at Arlington</a></section></br>
         <section>SEIR 365 | Arlington TX 76010</section></br>
    </div>
    <div class="social-icons">

        
        <a href="https://facebook.com/cdslab" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-facebook fa-stack-1x"></i>
            </span>
        </a>
        

        
        <a href="https://github.com/cdslaborg" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-github fa-stack-1x"></i>
            </span>
        </a>
        

        

        
        <a href="https://instagram.com/cdslaborg" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-instagram fa-stack-1x"></i>
            </span>
        </a>
        

        
        <a href="https://medium.com/cdslab" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-medium fa-stack-1x"></i>
                <!--
                -->
            </span>
        </a>
        

        
        <a href="https://twitter.com/cdslaborg" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-twitter fa-stack-1x"></i>
            </span>
        </a>
        
        
<div style="color: #000000; float: none; width: 100%; padding-top: 1rem;">
    <span style="font-size:0.8em">visitor count: 
        <script type="text/javascript">
            var sc_project=12051053; 
            var sc_invisible=0; 
            var sc_security="e095256f"; 
            var sc_text=3; 
            var scJsHost = "https://";
            document.write("<sc"+"ript type='text/javascript' src='" + scJsHost + 
            "statcounter.com/counter/counter.js'></"+"script>");
        </script>
    </span>
</div>


    </div>
    <div class="cf"></div>
</footer> 
    </main>
    <!--dynamic page header-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="/recipes/assets/js/vendor/jquery-1.11.1.min.js"><\/script>')</script>
  <script src="/recipes/assets/js/vendor/modernizr.js"></script>
  <script src="/recipes/assets/js/foundation.min.js"></script>
  
  <script src="/recipes/assets/js/notepad.js"></script>
  <script src="/recipes/assets/js/scripts.min.js"></script>
  <script src="/recipes/assets/js/vendor/nprogress.js"></script>
  
  <script>
    $(document).foundation();
  </script>
  <script type='text/javascript'>console.log("N/A");</script>
  <script type='text/javascript'>console.log("https://www.cdslab.org/");</script>

<!--header anchor links-->
<script src="/recipes/assets/js/autoAnchorLink.js"></script>

<!-- <script src="/recipes/assets/js/prismOkaidia.js"></script>
<script src="/recipes/assets/js/prismTwilight.js"></script>
<script src="/recipes/assets/js/prismDefault.js"></script>
 -->
<script src="/recipes/assets/js/prismCoy.js"></script> 
    <!--automatic Table of Content.-->
    <script src="/recipes/assets/js/autoTOC.js"></script>
</body>
</html>
